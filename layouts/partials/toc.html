{{ if and (.TableOfContents) (eq .Type "blog") }}
<div class="toc-container">
  <div class="toc-content">
    <h4 class="toc-title">Content</h4>
    {{ .TableOfContents }}
  </div>
  
  <!-- Carbon Ads in Sidebar -->
  <div class="sidebar-ads">
    <div id="carbon-container-sidebar"></div>
  </div>
</div>

<style>
.toc-container {
  position: fixed;
  top: 180px;
  right: 3rem;
  max-width: 200px;
  z-index: 10;
}

.toc-content {
  position: relative;
}

.toc-title {
  font-size: 0.75rem;
  font-weight: 600;
  margin: 0 0 1rem 1rem;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding-left: 0;
  border-left: 1px solid #e3e8ee;
  padding-left: 1rem;
}

.toc-content nav {
  margin: 0;
}

.toc-content ul {
  margin: 0;
  padding: 0;
  list-style: none;
  font-size: 0.8125rem;
  line-height: 1.75;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

.toc-content li {
  margin: 0;
}

.toc-content a {
  color: #8a919e;
  text-decoration: none;
  display: block;
  padding: 0.125rem 0 0.125rem 1rem;
  transition: all 0.15s ease;
  border-left: 1px solid #e3e8ee;
  position: relative;
}

.toc-content a:hover {
  color: #0a2540;
  border-left-color: #8cc2dd;
  background: linear-gradient(90deg, rgba(8, 67, 85, 0.04) 0%, transparent 100%);
}

.toc-content a:active,
.toc-content a:focus {
  color: #635bff;
  border-left-color: #635bff;
}

/* Nested items */
.toc-content li li {
  margin-left: 1rem;
}

.toc-content li li a {
  font-size: 0.75rem;
  color: #a3acb9;
}

.toc-content li li li {
  display: none; /* Hide deeply nested items */
}


/* Dark mode support */
@media (prefers-color-scheme: dark) {
  .toc-content a {
    color: #7a8291;
    border-left-color: #2a2f3a;
  }
  
  .toc-content a:hover {
    color: #f7fafc;
    border-left-color: #8cc2dd;
    background: linear-gradient(90deg, rgba(8, 67, 85, 0.08) 0%, transparent 100%);
  }
  
  .toc-content li li a {
    color: #525866;
  }
  
  .toc-title {
    color: #9ca3af;
    border-left-color: #2a2f3a;
  }
  
  #carbon-container-sidebar .carbon-text {
    color: #7a8291 !important;
  }
  
  #carbon-container-sidebar .carbon-text:hover {
    color: #f7fafc !important;
  }
  
  #carbon-container-sidebar .carbon-poweredby {
    color: #525866 !important;
  }
  
  .toc-container::before {
    background: #2a2f3a;
  }
}

/* Hide on smaller screens */
@media (max-width: 1400px) {
  .toc-container {
    display: none;
  }
}

/* Smooth scroll behavior */
html {
  scroll-behavior: smooth;
}

/* Add offset for fixed header */
h2[id], h3[id], h4[id] {
  scroll-margin-top: 80px;
}

/* Sidebar Ads Styling */
.sidebar-ads {
  margin-top: 3rem;
  max-width: 200px;
}

#carbon-container-sidebar #carbonads {
  display: block !important;
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
  margin: 0 !important;
  font-size: 0.75rem !important;
  line-height: 1.5 !important;
  box-shadow: none !important;
}

#carbon-container-sidebar .carbon-wrap {
  display: block !important;
  gap: 0.5rem !important;
}

#carbon-container-sidebar .carbon-img {
  margin-bottom: 0.75rem !important;
}

#carbon-container-sidebar img {
  width: 100% !important;
  max-width: 130px !important;
  height: auto !important;
  border-radius: 6px !important;
  opacity: 0.8;
  transition: opacity 0.2s ease;
}

#carbon-container-sidebar img:hover {
  opacity: 1;
}

#carbon-container-sidebar .carbon-text {
  color: #8a919e !important;
  font-size: 0.75rem !important;
  line-height: 1.4 !important;
  text-decoration: none !important;
  display: block !important;
  margin-bottom: 0.375rem !important;
}

#carbon-container-sidebar .carbon-text:hover {
  color: #0a2540 !important;
}

#carbon-container-sidebar .carbon-poweredby {
  color: #a3acb9 !important;
  font-size: 0.6875rem !important;
  text-decoration: none !important;
  opacity: 0.8 !important;
}

#carbon-container-sidebar .carbon-poweredby:hover {
  opacity: 1 !important;
}
</style>

<script>
(function() {
    const SERVE_ID = 'CW7IL5QE';
    const PLACEMENT = 'aiengineerguidecom';
    const FORMAT = 'responsive';
    
    const carbonAdsUrl = `//cdn.carbonads.com/carbon.js?serve=${SERVE_ID}&placement=${PLACEMENT}&format=${FORMAT}`;
    
    function loadSidebarCarbonAds() {
        // Check if carbonads already exists in sidebar
        const isCarbonExist = document.querySelector('#carbon-container-sidebar #carbonads');
        
        if (isCarbonExist) {
            return;
        }
        
        // Check if script already exists
        const carbonScript = document.querySelector('#_carbonads_js_sidebar');
        
        if (carbonScript === null) {
            const script = document.createElement('script');
            script.src = carbonAdsUrl;
            script.id = '_carbonads_js_sidebar';
            script.async = true;
            
            const container = document.querySelector('#carbon-container-sidebar');
            if (container) {
                container.appendChild(script);
            }
        }
    }
    
    // Load ads when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadSidebarCarbonAds);
    } else {
        loadSidebarCarbonAds();
    }
})();
</script>

{{ end }} 
